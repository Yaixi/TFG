<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- ==================== ESTILOS (CSS) ==================== -->
  <!-- Bootstrap y Font Awesome -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" rel="stylesheet">
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
  
  <!-- Estilos de Leaflet y sus Plugins -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
  
  <!-- Tu CSS personalizado (ruta absoluta para que funcione en todas las páginas) -->
  <link rel='stylesheet' href='/stylesheets/style.css'/>

  <!-- ======================================================================================== -->
  <!-- ============= SCRIPTS (JAVASCRIPT) - ¡ESTE ORDEN ES MUY IMPORTANTE! ============= -->
  <!-- ======================================================================================== -->

  <!-- Primero, librerías generales como jQuery -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

  <!-- 1. LIBRERÍA PRINCIPAL DE LEAFLET (DEBE IR PRIMERO) -->
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  
  <!-- 2. AHORA, LOS PLUGINS QUE DEPENDEN DE LEAFLET -->
  <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>
  <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
  <script src="https://unpkg.com/leaflet-pip@1.1.0/leaflet-pip.js"></script>
  
  <!-- 3. Al final, Bootstrap (que depende de jQuery) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</head>

<header id="header">
  <div class="top"></div>
  <nav class="navbar navbar-expand-lg rounded" style="background: #0d1a2d90; backdrop-filter: blur(10px); background-size: cover; background-position: center;">
    <div class="container">
      <a class="fa fa-map-location navbar-brand" href="/"> M€B</a>
      <span class="navbar-text">MADRID DE BOLSILLO</span>
      <button style="background-color: #ccc;" class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav"  aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="fa fa-house nav-link" href="/"> Inicio</a>
          </li>
          <li class="nav-item">
            <a class="fa fa-circle-question nav-link" href="/acerca"> Acerca de</a>
          </li>
          <li class="nav-item">
            <a class="fa fa-id-card-clip nav-link" href="/contacto"> Contacto</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              <% if (user && user.name) { %>
                <i class="fa fa-user"> <%= user.name %> </i>
              <% } else { %>
                <i class="fa fa-user"> Invitado </i>
              <% } %>
            </a>
            <ul class="dropdown-menu" style="background-color: #ccc;" aria-labelledby="navbarDropdown">
              <% if (user) { %>
                <li><a class="dropdown-item" style="color: #0d1a2d;" href="/users/logout">Cerrar Sesión</a></li>
              <% } else { %>
                <li><a class="dropdown-item" style="color: #0d1a2d;" href="/users/login">Iniciar Sesión</a></li>
                <li><a class="dropdown-item" href="/users/signup" style="color: #0d1a2d;">Registrarse</a></li>
              <% } %>
            </ul>
          </li>

          <% if (user && user.isAdmin) { %>
            <li class="nav-item">
              <a class="fa fa-user-shield nav-link" href="/admin"> Panel de Administrador</a>
            </li>
          <% } %>
          
        </ul>
      </div>
    </div>
  </nav>
  <% if (user) { %>
    <h6 class="text-end p-2">Bienvenid@: <%= user.name %> (<%= user.email %>)</h6>
  <% } else { %>
    <h6 class="p-2">Bienvenid@. ¿Aún no te has creado un usuario? Inicia sesión o regístrate ya</h6>
  <% } %>
</header>